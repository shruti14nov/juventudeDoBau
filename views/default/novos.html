{{extend 'top-nav.html'}}

{{for post in posts[0]:}}
<div class="box box-widget">
  <div class="box-header with-border">
    <div class="user-block">
      <a href="{{=URL('perfil', vars={'user_id':post.created_by.id})}}">
        <img class="img-circle" src="{{=URL('download', args=post.created_by.avatar)}}" alt="{{=post.created_by.nome}}">
          <span class="username">{{=post.created_by.first_name}} {{=T('digou')}}:
        </a></span>
      <span class="description">{{=prettydate(post.created_on)}}</span>
    </div><!-- /.user-block -->
    {{n_comments = 0}}
    {{for c in comentarios:}}
      {{if c.id == post.id:}}
        {{n_comments += 1}}
      {{pass}}
    {{pass}}
    <div class="box-tools">
      <a class=pull-right href="{{=URL('default', 'post', args=post.id)}}">{{=n_comments}} comentários</a>
    </div><!-- /.box-tools -->
  </div><!-- /.box-header -->
  <div class="box-body">
    <!-- post text -->
    {{=DIV(MARKMIN(post.corpo), _class='post-body')}} </br>
    <hr>
    <!-- Social sharing buttons -->
    <p>{{=LOAD('default', 'curtir.load', vars={'id':post.id, 'voto':'legal'}, ajax=True)}}</p>
  </div><!-- /.box-body -->
</div><!-- /.box -->
{{pass}}

<div class="pager">
  {{if int(request.vars.pagina) != 1:}}
    <a href="{{=URL('default', 'timeline', args=request.args, vars={'pagina':int(request.vars.pagina)-1})}}">❮ Anterior</a>&emsp;
  {{pass}}
  {{if int(request.vars.pagina) < posts[2]/10.0:}}
    <a href="{{=URL('default', 'timeline', args=request.args, vars={'pagina':int(request.vars.pagina)+1})}}">Próxima ❯</a>&emsp;
  {{pass}}
</div>

</div>
